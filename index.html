<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Jqgram : JQGram tree edit distance approximation, Javascript port of PyGram with some additional functionality" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Jqgram</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/hoonto/jqgram">View on GitHub</a>

          <h1 id="project_title">Jqgram</h1>
          <h2 id="project_tagline">JQGram tree edit distance approximation, Javascript port of PyGram with some additional functionality</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/hoonto/jqgram/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/hoonto/jqgram/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="jqgram" class="anchor" href="#jqgram"><span class="octicon octicon-link"></span></a>jqgram</h1>

<p>This module implements the PQ-Gram tree edit distance approximation algorithm for both server-side and browser-side applications; O(n log n) time and O(n) space performant where n is number of nodes in the trees.</p>

<p>The PQ-Gram approximation is much faster than obtaining the true edit distance via Zhang &amp; Shasha, Klein, or Guha et. al, whom provide true edit distance algorithms that all perform minimum O(n<sup>2</sup>) time in O(n) space and are therefore unsuitable for many applications at scale.</p>

<p>Often in real-world applications it is not necessary to know the true edit distance if a relative approximation of multiple trees to a known standard can be obtained.  Javascript, in the browser and now on the server with the advent of Node.js deal frequently with tree structures and end-user performance is usually critical in algorithm implementation and design; thus jqgram.</p>

<p>jqgram is currently used in applications in private beta at hoonto.com and clipwidget.com. </p>

<p><a href="http://ci.testling.com/hoonto/jqgram"><img src="http://ci.testling.com/hoonto/jqgram.png" alt="browser support"></a></p>

<p>Note: IE is not passing tests according to testling, however I will dig into this at a later date, please let me know if this is critical for your application and enter an issue.</p>

<p>Please also note that I am currently generating documentation so the project will be in a little bit of flux over the next couple days.</p>

<p>Rgds....Hoonto/Matt</p>

<h1>
<a name="description" class="anchor" href="#description"><span class="octicon octicon-link"></span></a>Description</h1>

<p>The jqgram API provides callbacks for node child and label determination in order to provide flexibility and applicability in Node and browser environments.  You may utilize your own tree structures or follow the DOM, cheerio, or basic object structure examples.</p>

<p>The PQ-Gram edit distance is pseudo-metric:</p>

<pre><code>1) Identity - edit_distance(a, a) = 0
2) Symmetric - edit_distance(a, b) = edit_distance(b, a) 
3) Triangle Inequality - edit_distance(a, b) + edit_distance(b, c) &gt;= edit_distance(a, c)
</code></pre>

<p>In effect, this means that if the PQ-Gram distance between tree A and B is less than the distance between tree C and D, then the true edit distance between A and B is less than or equal to the distance between C and D. Note that an edit distance of 0 does not mean the two trees are identical, only very similar.</p>

<h1>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h1>

<p>To use jqgram distance you need only create a jqgram object providing callbacks for label and children definition for trees being compared.  As the callbacks are per-tree, you can approximate edit distance between two different tree implementations.  For example, you could compare a tree generated from JSON with a DOM subtree.  You only need to pass in the root of each tree and the provided label and child callback functions will be used to generate the rest of the tree.  Another use case might be comparing an abstract syntax tree generated with Esprima with that created by Uglify2 or Acorn, or with something entirely of your own creation.  Note: default p and q are 2 and 3 respectively.</p>

<div class="highlight"><pre><span class="nx">npm</span> <span class="nx">install</span> <span class="nx">jqgram</span>
</pre></div>

<h1>
<a name="basic-example" class="anchor" href="#basic-example"><span class="octicon octicon-link"></span></a>Basic example</h1>

<div class="highlight"><pre><span class="kd">var</span> <span class="nx">jq</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"jqgram"</span><span class="p">).</span><span class="nx">jqgram</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">root1</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"thelabel"</span><span class="o">:</span> <span class="s2">"a"</span><span class="p">,</span>
    <span class="s2">"thekids"</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">"thelabel"</span><span class="o">:</span> <span class="s2">"b"</span><span class="p">,</span>
        <span class="s2">"thekids"</span><span class="o">:</span> <span class="p">[</span>
                <span class="p">{</span> <span class="s2">"thelabel"</span><span class="o">:</span> <span class="s2">"c"</span> <span class="p">},</span>
                <span class="p">{</span> <span class="s2">"thelabel"</span><span class="o">:</span> <span class="s2">"d"</span> <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span> <span class="s2">"thelabel"</span><span class="o">:</span> <span class="s2">"e"</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">"thelabel"</span><span class="o">:</span> <span class="s2">"f"</span> <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">root2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"a"</span><span class="p">,</span>
    <span class="s2">"kiddos"</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"b"</span><span class="p">,</span>
        <span class="s2">"kiddos"</span><span class="o">:</span> <span class="p">[</span>
                <span class="p">{</span> <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"c"</span> <span class="p">},</span>
                <span class="p">{</span> <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"d"</span> <span class="p">},</span>
                <span class="p">{</span> <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"y"</span> <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span> <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"e"</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"x"</span> <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="nx">jq</span><span class="p">.</span><span class="nx">distance</span><span class="p">({</span>
    <span class="nx">root</span><span class="o">:</span> <span class="nx">root1</span><span class="p">,</span>
    <span class="nx">lfn</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span> <span class="k">return</span> <span class="nx">node</span><span class="p">.</span><span class="nx">thelabel</span><span class="p">;</span> <span class="p">},</span>
    <span class="nx">cfn</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span> <span class="k">return</span> <span class="nx">node</span><span class="p">.</span><span class="nx">thekids</span><span class="p">;</span> <span class="p">}</span>
<span class="p">},{</span>
    <span class="nx">root</span><span class="o">:</span> <span class="nx">root2</span><span class="p">,</span>
    <span class="nx">lfn</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span> <span class="k">return</span> <span class="nx">node</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span> <span class="p">},</span>
    <span class="nx">cfn</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span> <span class="k">return</span> <span class="nx">node</span><span class="p">.</span><span class="nx">kiddos</span><span class="p">;</span> <span class="p">}</span>
<span class="p">},{</span> <span class="nx">p</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span> <span class="nx">q</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span> <span class="nx">depth</span><span class="o">:</span><span class="mi">10</span> <span class="p">},</span>
<span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">distance</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

<hr><pre><code>0.6428571428571428
</code></pre>

<h1>
<a name="dom-vs-object" class="anchor" href="#dom-vs-object"><span class="octicon octicon-link"></span></a>DOM vs Object</h1>

<div class="highlight"><pre><span class="c1">// This could probably be optimized significantly, but is a real-world</span>
<span class="c1">// example of how to use tree edit distance in the browser.</span>

<span class="c1">// jqgram:</span>
<span class="kd">var</span> <span class="nx">jq</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"jqgram"</span><span class="p">).</span><span class="nx">jqgram</span><span class="p">;</span>

<span class="c1">// Make a DOM-ish structure out of objects:</span>
<span class="kd">var</span> <span class="nx">mydom</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"body"</span><span class="p">,</span>
    <span class="s2">"chittles"</span><span class="o">:</span> <span class="p">[</span> 
        <span class="p">{</span> <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"div"</span><span class="p">,</span>
        <span class="s2">"chittles"</span><span class="o">:</span> <span class="p">[</span>
                <span class="p">{</span> <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"a"</span> <span class="p">},</span> <span class="c1">// The id attribute</span>
                <span class="p">{</span> <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"div"</span><span class="p">,</span>
                  <span class="s2">"chittles"</span><span class="o">:</span> <span class="p">[</span>
                    <span class="p">{</span> <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"c"</span> <span class="p">},</span> <span class="c1">// The "c" class</span>
                    <span class="p">{</span> <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"d"</span> <span class="p">},</span> <span class="c1">// The "d" class</span>
                    <span class="p">{</span> <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"span"</span> <span class="p">}</span>
                  <span class="p">]</span> 
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">},</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="c1">// For ease, lets assume you have jQuery laoded:</span>
<span class="kd">var</span> <span class="nx">realdom</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'body'</span><span class="p">);</span>

<span class="c1">// The lfn and cfn functions allow you to specify</span>
<span class="c1">// how labels and children should be defined:</span>
<span class="nx">jq</span><span class="p">.</span><span class="nx">distance</span><span class="p">({</span>
    <span class="nx">root</span><span class="o">:</span> <span class="nx">mydom</span><span class="p">,</span>
    <span class="nx">lfn</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span> <span class="k">return</span> <span class="nx">node</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span> <span class="p">},</span>
    <span class="nx">cfn</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span> <span class="k">return</span>  <span class="nx">node</span><span class="p">.</span><span class="nx">chittles</span><span class="p">;</span> <span class="p">}</span>
<span class="p">},{</span>
    <span class="nx">root</span><span class="o">:</span> <span class="nx">realdom</span><span class="p">,</span>
    <span class="nx">lfn</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span> 
        <span class="k">return</span> <span class="nx">node</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span> 
    <span class="p">},</span>
    <span class="nx">cfn</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span> 
        <span class="kd">var</span> <span class="nx">retarr</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!!</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span> <span class="o">&amp;&amp;</span> <span class="o">!!</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="kr">class</span> <span class="o">&amp;&amp;</span> <span class="o">!!</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="kr">class</span><span class="p">.</span><span class="nx">nodeValue</span><span class="p">){</span>
            <span class="nx">retarr</span> <span class="o">=</span> <span class="nx">retarr</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="kr">class</span><span class="p">.</span><span class="nx">nodeValue</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">' '</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!!</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span> <span class="o">&amp;&amp;</span> <span class="o">!!</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">id</span> <span class="o">&amp;&amp;</span> <span class="o">!!</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">nodeValue</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">retarr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">nodeValue</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">node</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">){</span>
            <span class="nx">retarr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">children</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">retarr</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">},{</span> <span class="nx">p</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span> <span class="nx">q</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span> <span class="nx">depth</span><span class="o">:</span><span class="mi">10</span> <span class="p">},</span>
<span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">distance</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

<hr><pre><code>// Output depends on how your pseudo-DOM subtree compares with the real DOM!
</code></pre>

<h1>
<a name="dom-vs-cheerio-example" class="anchor" href="#dom-vs-cheerio-example"><span class="octicon octicon-link"></span></a>DOM vs Cheerio example</h1>

<div class="highlight"><pre><span class="c1">// This could probably be optimized significantly, but is a real-world</span>
<span class="c1">// example of how to use tree edit distance in the browser.</span>

<span class="c1">// For cheerio, you'll have to browserify, </span>
<span class="c1">// which requires some fiddling around</span>
<span class="c1">// due to cheerio's dynamically generated </span>
<span class="c1">// require's (good grief) that browserify </span>
<span class="c1">// does not see due to the static nature </span>
<span class="c1">// of its code analysis (dynamic off-line</span>
<span class="c1">// analysis is hard, but doable).</span>
<span class="c1">//</span>
<span class="c1">// Ultimately, the goal is to end up with </span>
<span class="c1">// something like this in the browser:</span>

<span class="kd">var</span> <span class="nx">cheerio</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./lib/cheerio'</span><span class="p">);</span> 

<span class="c1">// The easy part, jqgram:</span>
<span class="kd">var</span> <span class="nx">jq</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"../jqgram"</span><span class="p">).</span><span class="nx">jqgram</span><span class="p">;</span>

<span class="c1">// Make a cheerio DOM:</span>
<span class="kd">var</span> <span class="nx">html</span> <span class="o">=</span> <span class="s1">'&lt;body&gt;&lt;div id="a"&gt;&lt;div class="c d"&gt;&lt;span&gt;Irrelevent text&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;'</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">cheeriodom</span> <span class="o">=</span> <span class="nx">cheerio</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="nx">html</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">ignoreWhitespace</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nx">lowerCaseTags</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">});</span>

<span class="c1">// For ease, lets assume you have jQuery laoded:</span>
<span class="kd">var</span> <span class="nx">realdom</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'body'</span><span class="p">);</span>

<span class="c1">// The lfn and cfn functions allow you to specify</span>
<span class="c1">// how labels and children should be defined:</span>
<span class="nx">jq</span><span class="p">.</span><span class="nx">distance</span><span class="p">({</span>
    <span class="nx">root</span><span class="o">:</span> <span class="nx">cheeriodom</span><span class="p">,</span>
    <span class="nx">lfn</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span> 
        <span class="c1">// We don't have to lowercase this because we already</span>
        <span class="c1">// asked cheerio to do that for us above (lowerCaseTags).</span>
        <span class="k">return</span> <span class="nx">node</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span> 
    <span class="p">},</span>
    <span class="nx">cfn</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span> 
        <span class="c1">// Cheerio maintains attributes in the attribs array:</span>
        <span class="c1">// We're going to put id's and classes in as children </span>
        <span class="c1">// of nodes in our cheerio tree</span>
        <span class="kd">var</span> <span class="nx">retarr</span> <span class="o">=</span> <span class="p">[];</span> 
        <span class="k">if</span><span class="p">(</span><span class="o">!!</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attribs</span> <span class="o">&amp;&amp;</span> <span class="o">!!</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attribs</span><span class="p">.</span><span class="kr">class</span><span class="p">){</span>
            <span class="nx">retarr</span> <span class="o">=</span> <span class="nx">retarr</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">attribs</span><span class="p">.</span><span class="kr">class</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">' '</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!!</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attribs</span> <span class="o">&amp;&amp;</span> <span class="o">!!</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attribs</span><span class="p">.</span><span class="nx">id</span><span class="p">){</span>
            <span class="nx">retarr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">attribs</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">retarr</span> <span class="o">=</span> <span class="nx">retarr</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">children</span><span class="p">);</span>
        <span class="k">return</span>  <span class="nx">retarr</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">},{</span>
    <span class="nx">root</span><span class="o">:</span> <span class="nx">realdom</span><span class="p">,</span>
    <span class="nx">lfn</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span> 
        <span class="k">return</span> <span class="nx">node</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span> 
    <span class="p">},</span>
    <span class="nx">cfn</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span> 
        <span class="kd">var</span> <span class="nx">retarr</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!!</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span> <span class="o">&amp;&amp;</span> <span class="o">!!</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="kr">class</span> <span class="o">&amp;&amp;</span> <span class="o">!!</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="kr">class</span><span class="p">.</span><span class="nx">nodeValue</span><span class="p">){</span>
            <span class="nx">retarr</span> <span class="o">=</span> <span class="nx">retarr</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="kr">class</span><span class="p">.</span><span class="nx">nodeValue</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">' '</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!!</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span> <span class="o">&amp;&amp;</span> <span class="o">!!</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">id</span> <span class="o">&amp;&amp;</span> <span class="o">!!</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">nodeValue</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">retarr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">nodeValue</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">node</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">){</span>
            <span class="nx">retarr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">children</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">retarr</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">},{</span> <span class="nx">p</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span> <span class="nx">q</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span> <span class="nx">depth</span><span class="o">:</span><span class="mi">10</span> <span class="p">},</span>
<span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">distance</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

<hr><pre><code>// Output depends on how your pseudo-DOM subtree compares with the real DOM!
</code></pre>

<h1>
<a name="credits-and-inspirations" class="anchor" href="#credits-and-inspirations"><span class="octicon octicon-link"></span></a>Credits and Inspirations</h1>

<p><a href="http://www.vldb2005.org/program/paper/wed/p301-augsten.pdf">The academic paper</a></p>

<p><a href="https://github.com/Sycondaman/PyGram">PyGram, python implementation</a>, from which jqgram was originally ported and main tests were recreated.</p>

<p>Includes slightly modified version of <a href="https://github.com/pvorb/node-clone">node-clone</a>. </p>

<p>Utilizes <a href="https://github.com/NobleJS/setImmediate">setImmediate</a>. </p>

<h1>
<a name="tips" class="anchor" href="#tips"><span class="octicon octicon-link"></span></a>Tips</h1>

<p>1)  The p and q values will change the distribution of the edit distance, which is a value between 0 and 1. In practice, you will likely not need to modify these.  Read the <a href="http://www.vldb2005.org/program/paper/wed/p301-augsten.pdf">the paper</a> referenced in the credits section above for more info on that.</p>

<p>2)  Node labels are compared lexicographically. Whenever node labels are overly descriptive, performance and accuracy of the algorithm can be increased dramatically by expanding node labels as new children.  In jqgram you can do this in your child callback function for each tree as shown in examples - for example using the id and each class name in the class attributes of DOM nodes as additional immediate children of the current node. </p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Jqgram maintained by <a href="https://github.com/hoonto">hoonto</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
